local RunService = game:GetService("RunService")
local Workspace = game:GetService("Workspace")
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local HttpService = game:GetService("HttpService")

-- ç­‰å¾…æ¸¸æˆåŠ è½½å®Œæˆ
if not game:IsLoaded() then
    game.Loaded:Wait()
end

-- ç­‰å¾…æœ¬åœ°ç©å®¶åŠ è½½
local LocalPlayer = Players.LocalPlayer
if not LocalPlayer then
    Players:GetPropertyChangedSignal("LocalPlayer"):Wait()
    LocalPlayer = Players.LocalPlayer
end

-- æ˜¾ç¤ºä½œè€…ä¿¡æ¯å’Œæç¤º
local authorMessage = Instance.new("Message")
authorMessage.Text = "å•ä¸€ç‰©ä½“æ¼‚æµ®æ§åˆ¶è„šæœ¬ - ä½œè€…: ciTiy\nåˆ¶ä½œçµæ„Ÿæ¥æºäºåé‡åŠ›çŠ¶æ€è„šæœ¬\n1: æ§åˆ¶çš„ç‰©ä½“å¯ä»¥è½½ç€åˆ«äººä¸€èµ·é£ï¼Œå‰ææ˜¯ä½ çš„ç½‘ç»œæµç•…å¹¶ä¸”ç¦»æ§åˆ¶çš„ç‰©ä½“ä¸è¿œ\n2: æŒ‰äº†åœæ­¢ç¿»è½¬åå†æŒ‰ä»»æ„ç§»åŠ¨é”®æ‰èƒ½çœŸæ­£åœæ­¢ç¿»è½¬\n3: åªèƒ½æ§åˆ¶æ²¡è¢«å›ºå®šçš„ç‰©ä½“ï¼\n4: åªæœ‰èƒ½è¢«è“è‰²æ¡†æ¶æ ‡è®°çš„æ‰æ˜¯â€œå¯èƒ½â€èƒ½æ§åˆ¶çš„ç‰©ä½“ï¼Œç‰©ä½“å¤ªå¤§æ§åˆ¶æ—¶å¯èƒ½æ§åˆ¶ä¸äº†\n5: æœ€å¥½ä¸è¦çŸ­æ—¶é—´å†…è¿ç»­ç‚¹å‡»å¹¶é•¿æŒ‰æ­¤è„šæœ¬çš„æ§åˆ¶æŒ‰é”®ï¼Œä¼šå‡ºç°é¢œè‰²æ•…éšœ\n6ï¼šé€‰å¥½ç‰©ä½“åå¯ä»¥å…³é—­é€‰æ‹©æ¨¡å¼\n7: æ­¤è„šæœ¬ä¸ºå…è´¹è„šæœ¬ï¼Œè¢«å€’å–éª—äº†æˆ‘ä¸è´Ÿè´£ğŸ˜°\næ›´æ–°äº†æ§åˆ¶é¢æ¿uiå¤§å°è°ƒèŠ‚åŠŸèƒ½ï¼Œè°ƒèŠ‚æŒ‰é’®åœ¨æœ€åº•ä¸‹\næ„Ÿè°¢ä½¿ç”¨"
authorMessage.Parent = Workspace
delay(5, function()
    authorMessage:Destroy()
end)

-- å…¨å±€å˜é‡
_G.selectedPart = nil
_G.selectedHighlight = nil
_G.floatSpeed = 10
_G.moveDirection = Vector3.new(0, 1, 0)
_G.flipX = 0
_G.flipY = 0
_G.flipZ = 0
_G.rotationSpeed = 1

-- è§’è‰²æ­»äº¡è‡ªåŠ¨é‡è¿åŠŸèƒ½
local function setupAutoReconnect()
    LocalPlayer.CharacterAdded:Connect(function(character)
        -- ç­‰å¾…è§’è‰²å®Œå…¨åŠ è½½
        character:WaitForChild("Humanoid")

        -- é‡æ–°è®¾ç½®æ¨¡æ‹ŸåŠå¾„
        setupSimulationRadius()

        print("è§’è‰²å·²é‡ç”Ÿï¼Œæ¼‚æµ®æ§åˆ¶è„šæœ¬å·²è‡ªåŠ¨é‡æ–°è¿æ¥")
    end)

    LocalPlayer.CharacterRemoving:Connect(function()
        -- è§’è‰²æ­»äº¡æ—¶å®‰å…¨åœ°åœæ­¢æ§åˆ¶
        if _G.selectedPart then
            pcall(function()
                StopPart()
                removeHighlight()
            end)
            _G.selectedPart = nil
        end
    end)
end

-- è®¾ç½®æ¨¡æ‹ŸåŠå¾„
local function setupSimulationRadius()
    local success, err = pcall(function()
        RunService.Heartbeat:Connect(function()
            pcall(function()
                sethiddenproperty(LocalPlayer, "SimulationRadius", math.huge)
                sethiddenproperty(LocalPlayer, "MaxSimulationRadius", math.huge)
            end)
        end)
    end)

    if not success then
        warn("æ¨¡æ‹ŸåŠå¾„è®¾ç½®å¤±è´¥: " .. tostring(err))
    end
end

setupSimulationRadius()
setupAutoReconnect() -- å¯åŠ¨è‡ªåŠ¨é‡è¿

-- åˆ›å»ºé«˜äº®æ•ˆæœ
local function createHighlight(part)
    if _G.selectedHighlight then
        _G.selectedHighlight:Destroy()
        _G.selectedHighlight = nil
    end

    local highlight = Instance.new("SelectionBox")
    highlight.Name = "FloatingHighlight"
    highlight.Adornee = part
    highlight.Color3 = Color3.fromRGB(0, 0, 255) -- è“è‰²
    highlight.LineThickness = 0.05
    highlight.Parent = part

    _G.selectedHighlight = highlight
    return highlight
end

-- ç§»é™¤é«˜äº®æ•ˆæœ
local function removeHighlight()
    if _G.selectedHighlight then
        _G.selectedHighlight:Destroy()
        _G.selectedHighlight = nil
    end
end

-- å¤„ç†é›¶ä»¶å‡½æ•°
local function ProcessPart(part)
    if not part or not part.Parent then return end

    -- æ¸…é™¤æ—§çš„èº«ä½“åŠ›
    for _, child in ipairs(part:GetChildren()) do
        if child:IsA("BodyVelocity") or child:IsA("BodyAngularVelocity") or 
           child:IsA("BodyForce") or child:IsA("BodyGyro") or 
           child:IsA("BodyPosition") or child:IsA("BodyThrust") then
            child:Destroy()
        end
    end

    -- æ·»åŠ èº«ä½“åŠ›
    local bodyVelocity = Instance.new("BodyVelocity")
    bodyVelocity.Velocity = _G.moveDirection.Unit * _G.floatSpeed
    bodyVelocity.MaxForce = Vector3.new(math.huge, math.huge, math.huge)
    bodyVelocity.Parent = part

    -- æ·»åŠ è§’é€Ÿåº¦ä»¥å®ç°ç¿»è½¬
    local bodyAngularVelocity = Instance.new("BodyAngularVelocity")
    bodyAngularVelocity.AngularVelocity = Vector3.new(_G.flipX, _G.flipY, _G.flipZ) * _G.rotationSpeed
    bodyAngularVelocity.MaxTorque = Vector3.new(math.huge, math.huge, math.huge)
    bodyAngularVelocity.Parent = part
end

-- åœæ­¢é›¶ä»¶ç§»åŠ¨
local function StopPart()
    if _G.selectedPart then
        for _, child in ipairs(_G.selectedPart:GetChildren()) do
            if child:IsA("BodyVelocity") or child:IsA("BodyAngularVelocity") then
                child:Destroy()
            end
        end
    end
end

-- åœæ­¢é›¶ä»¶ç¿»è½¬
local function StopFlip()
    if _G.selectedPart then
        for _, child in ipairs(_G.selectedPart:GetChildren()) do
            if child:IsA("BodyAngularVelocity") then
                child:Destroy()
            end
        end
        -- é‡ç½®ç¿»è½¬å€¼
        _G.flipX = 0
        _G.flipY = 0
        _G.flipZ = 0
    end
end

-- æ›´æ–°é›¶ä»¶ç§»åŠ¨
local function UpdatePartMovement()
    if _G.selectedPart then
        StopPart()
        ProcessPart(_G.selectedPart)
    end
end

-- æ£€æŸ¥é›¶ä»¶æ˜¯å¦å¯æ§åˆ¶
local function IsPartControllable(part)
    return part:IsA("Part") and not part.Anchored and not part.Parent:FindFirstChild("Humanoid") and 
           not part.Parent:FindFirstChild("Head") and part.Parent ~= LocalPlayer.Character
end

-- é€‰æ‹©é›¶ä»¶å‡½æ•°
local function SelectPart(part)
    -- æ£€æŸ¥é›¶ä»¶æ˜¯å¦å¯æ§åˆ¶
    if IsPartControllable(part) then
        -- å¦‚æœå·²ç»æœ‰é€‰ä¸­çš„é›¶ä»¶ï¼Œå–æ¶ˆé€‰æ‹©
        if _G.selectedPart and _G.selectedPart ~= part then
            removeHighlight()
            StopPart()
        end

        -- é€‰æ‹©æ–°é›¶ä»¶
        _G.selectedPart = part
        createHighlight(part)
        ProcessPart(part)
        return true
    end
    return false
end

-- å–æ¶ˆé€‰æ‹©é›¶ä»¶
local function DeselectPart()
    if _G.selectedPart then
        removeHighlight()
        StopPart()
        _G.selectedPart = nil
    end
end

-- å°„çº¿æ£€æµ‹å‡½æ•°
local function getTargetPart()
    local camera = Workspace.CurrentCamera
    local mousePos = UserInputService:GetMouseLocation()
    local unitRay = camera:ViewportPointToRay(mousePos.X, mousePos.Y)
    local ray = Ray.new(unitRay.Origin, unitRay.Direction * 1000)

    local part, position = Workspace:FindPartOnRay(ray, LocalPlayer.Character)
    return part
end

-- è·å–åŸºäºè§†è§’çš„æ–¹å‘
local function getCameraRelativeDirection(direction)
    local camera = Workspace.CurrentCamera
    if not camera then return direction end

    local cameraCFrame = camera.CFrame
    local relativeDirection = Vector3.new(0, 0, 0)

    -- å°†ä¸–ç•Œåæ ‡ç³»çš„æ–¹å‘è½¬æ¢ä¸ºåŸºäºè§†è§’çš„æ–¹å‘
    if direction == Vector3.new(0, 0, 1) then -- å‰
        relativeDirection = cameraCFrame.LookVector
        relativeDirection = Vector3.new(relativeDirection.X, 0, relativeDirection.Z).Unit
    elseif direction == Vector3.new(0, 0, -1) then -- å
        relativeDirection = -cameraCFrame.LookVector
        relativeDirection = Vector3.new(relativeDirection.X, 0, relativeDirection.Z).Unit
    elseif direction == Vector3.new(-1, 0, 0) then -- å·¦
        relativeDirection = -cameraCFrame.RightVector
        relativeDirection = Vector3.new(relativeDirection.X, 0, relativeDirection.Z).Unit
    elseif direction == Vector3.new(1, 0, 0) then -- å³
        relativeDirection = cameraCFrame.RightVector
        relativeDirection = Vector3.new(relativeDirection.X, 0, relativeDirection.Z).Unit
    else
        -- ä¸Šä¸‹æ–¹å‘ä¿æŒä¸å˜
        relativeDirection = direction
    end

    return relativeDirection
end

-- ä½¿GUIå…ƒç´ å¯æ‹–åŠ¨çš„å‡½æ•°
local function MakeDraggable(gui)
    gui.Active = true
    gui.Draggable = true

    local dragHandle = Instance.new("Frame")
    dragHandle.Name = "DragHandle"
    dragHandle.Size = UDim2.new(0, 20, 0, 20)
    dragHandle.Position = UDim2.new(1, -20, 0, 0)
    dragHandle.BackgroundColor3 = Color3.fromRGB(150, 150, 150)
    dragHandle.BorderSizePixel = 0
    dragHandle.Parent = gui

    local gripIcon = Instance.new("TextLabel")
    gripIcon.Name = "GripIcon"
    gripIcon.Size = UDim2.new(1, 0, 1, 0)
    gripIcon.Position = UDim2.new(0, 0, 0, 0)
    gripIcon.Text = "â‰¡"
    gripIcon.TextColor3 = Color3.new(1, 1, 1)
    gripIcon.BackgroundTransparency = 1
    gripIcon.TextSize = 14
    gripIcon.Parent = dragHandle

    dragHandle.Active = true
    dragHandle.Draggable = true
end

-- åˆ›å»ºæ‰‹æœºå‹å¥½çš„GUI
local function CreateMobileGUI()
    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "SingleObjectFloatingControl"
    screenGui.ResetOnSpawn = false  -- é˜²æ­¢é‡ç”Ÿæ—¶GUIæ¶ˆå¤±
    screenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")

    -- é€‰æ‹©æ¨¡å¼å¼€å…³æŒ‰é’® - ç§»åŠ¨åˆ°å³ä¸Šè§’
    local selectModeButton = Instance.new("TextButton")
    selectModeButton.Name = "SelectModeToggle"
    selectModeButton.Size = UDim2.new(0, 150, 0, 50)
    selectModeButton.Position = UDim2.new(1, -160, 0, 10) -- å³ä¸Šè§’
    selectModeButton.Text = "é€‰æ‹©æ¨¡å¼: å…³é—­"
    selectModeButton.TextSize = 16
    selectModeButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
    selectModeButton.TextColor3 = Color3.new(1, 1, 1)
    selectModeButton.Parent = screenGui

    MakeDraggable(selectModeButton)

    -- æ§åˆ¶é¢æ¿
    local controlPanel = Instance.new("Frame")
    controlPanel.Name = "ControlPanel"
    controlPanel.Size = UDim2.new(0, 300, 0, 650) -- å¢åŠ é«˜åº¦ä»¥å®¹çº³æ–°æŒ‰é’®
    controlPanel.Position = UDim2.new(0.5, -150, 0.5, -325)
    controlPanel.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
    controlPanel.BackgroundTransparency = 0.3
    controlPanel.BorderSizePixel = 0
    controlPanel.Visible = false
    controlPanel.Parent = screenGui

    MakeDraggable(controlPanel)

    -- UIç¼©æ”¾æ§åˆ¶
    local uiScale = Instance.new("UIScale")
    uiScale.Scale = 1.0
    uiScale.Parent = controlPanel

    local scaleLabel = Instance.new("TextLabel")
    scaleLabel.Name = "ScaleLabel"
    scaleLabel.Size = UDim2.new(1, 0, 0, 40)
    scaleLabel.Position = UDim2.new(0, 0, 0, 570)
    scaleLabel.Text = "UIå¤§å°: 1.0"
    scaleLabel.TextColor3 = Color3.new(1, 1, 1)
    scaleLabel.BackgroundTransparency = 1
    scaleLabel.TextSize = 20
    scaleLabel.Parent = controlPanel

    local scaleUpButton = Instance.new("TextButton")
    scaleUpButton.Name = "ScaleUp"
    scaleUpButton.Size = UDim2.new(0, 60, 0, 60)
    scaleUpButton.Position = UDim2.new(0.7, 0, 0, 600)
    scaleUpButton.Text = "+"
    scaleUpButton.TextSize = 30
    scaleUpButton.BackgroundColor3 = Color3.fromRGB(0, 200, 0)
    scaleUpButton.TextColor3 = Color3.new(1, 1, 1)
    scaleUpButton.Parent = controlPanel

    local scaleDownButton = Instance.new("TextButton")
    scaleDownButton.Name = "ScaleDown"
    scaleDownButton.Size = UDim2.new(0, 60, 0, 60)
    scaleDownButton.Position = UDim2.new(0.3, 0, 0, 600)
    scaleDownButton.Text = "-"
    scaleDownButton.TextSize = 30
    scaleDownButton.BackgroundColor3 = Color3.fromRGB(200, 0, 0)
    scaleDownButton.TextColor3 = Color3.new(1, 1, 1)
    scaleDownButton.Parent = controlPanel

    -- é€Ÿåº¦æ§åˆ¶
    local speedLabel = Instance.new("TextLabel")
    speedLabel.Name = "SpeedLabel"
    speedLabel.Size = UDim2.new(1, 0, 0, 40)
    speedLabel.Position = UDim2.new(0, 0, 0, 10)
    speedLabel.Text = "é€Ÿåº¦: " .. _G.floatSpeed
    speedLabel.TextColor3 = Color3.new(1, 1, 1)
    speedLabel.BackgroundTransparency = 1
    speedLabel.TextSize = 20
    speedLabel.Parent = controlPanel

    -- é€Ÿåº¦å¢åŠ æŒ‰é’®
    local speedUpButton = Instance.new("TextButton")
    speedUpButton.Name = "SpeedUp"
    speedUpButton.Size = UDim2.new(0, 60, 0, 60)
    speedUpButton.Position = UDim2.new(0.7, 0, 0, 60)
    speedUpButton.Text = "+"
    speedUpButton.TextSize = 30
    speedUpButton.BackgroundColor3 = Color3.fromRGB(0, 200, 0)
    speedUpButton.TextColor3 = Color3.new(1, 1, 1)
    speedUpButton.Parent = controlPanel

    -- é€Ÿåº¦å‡å°‘æŒ‰é’®
    local speedDownButton = Instance.new("TextButton")
    speedDownButton.Name = "SpeedDown"
    speedDownButton.Size = UDim2.new(0, 60, 0, 60)
    speedDownButton.Position = UDim2.new(0.3, 0, 0, 60)
    speedDownButton.Text = "-"
    speedDownButton.TextSize = 30
    speedDownButton.BackgroundColor3 = Color3.fromRGB(200, 0, 0)
    speedDownButton.TextColor3 = Color3.new(1, 1, 1)
    speedDownButton.Parent = controlPanel

    -- åœæ­¢ç§»åŠ¨æŒ‰é’®
    local stopButton = Instance.new("TextButton")
    stopButton.Name = "Stop"
    stopButton.Size = UDim2.new(0, 100, 0, 40)
    stopButton.Position = UDim2.new(0.5, -50, 0, 130)
    stopButton.Text = "åœæ­¢ç§»åŠ¨"
    stopButton.TextSize = 16
    stopButton.BackgroundColor3 = Color3.fromRGB(200, 100, 100)
    stopButton.TextColor3 = Color3.new(1, 1, 1)
    stopButton.Parent = controlPanel

    -- åœæ­¢ç¿»è½¬æŒ‰é’®
    local stopFlipButton = Instance.new("TextButton")
    stopFlipButton.Name = "StopFlip"
    stopFlipButton.Size = UDim2.new(0, 100, 0, 40)
    stopFlipButton.Position = UDim2.new(0.5, -50, 0, 180)
    stopFlipButton.Text = "åœæ­¢ç¿»è½¬"
    stopFlipButton.TextSize = 16
    stopFlipButton.BackgroundColor3 = Color3.fromRGB(200, 100, 100)
    stopFlipButton.TextColor3 = Color3.new(1, 1, 1)
    stopFlipButton.Parent = controlPanel

    -- æ–¹å‘æ§åˆ¶æ ‡é¢˜
    local directionLabel = Instance.new("TextLabel")
    directionLabel.Name = "DirectionLabel"
    directionLabel.Size = UDim2.new(1, 0, 0, 40)
    directionLabel.Position = UDim2.new(0, 0, 0, 230)
    directionLabel.Text = "ç§»åŠ¨æ–¹å‘ (åŸºäºè§†è§’)"
    directionLabel.TextColor3 = Color3.new(1, 1, 1)
    directionLabel.BackgroundTransparency = 1
    directionLabel.TextSize = 20
    directionLabel.Parent = controlPanel

    -- æ–¹å‘æŒ‰é’®ç½‘æ ¼
    local directions = {
        {name = "å‘ä¸Š", dir = Vector3.new(0, 1, 0), pos = UDim2.new(0.5, -30, 0, 280)},
        {name = "å‘ä¸‹", dir = Vector3.new(0, -1, 0), pos = UDim2.new(0.5, -30, 0, 350)},
        {name = "å‘å‰", dir = Vector3.new(0, 0, 1), pos = UDim2.new(0.2, -30, 0, 315)},
        {name = "å‘å", dir = Vector3.new(0, 0, -1), pos = UDim2.new(0.8, -30, 0, 315)},
        {name = "å‘å·¦", dir = Vector3.new(-1, 0, 0), pos = UDim2.new(0.05, -30, 0, 315)},
        {name = "å‘å³", dir = Vector3.new(1, 0, 0), pos = UDim2.new(0.95, -30, 0, 315)}
    }

    for i, dirInfo in ipairs(directions) do
        local button = Instance.new("TextButton")
        button.Name = dirInfo.name
        button.Size = UDim2.new(0, 60, 0, 60)
        button.Position = dirInfo.pos
        button.Text = dirInfo.name
        button.TextSize = 14
        button.BackgroundColor3 = Color3.fromRGB(100, 100, 200)
        button.TextColor3 = Color3.new(1, 1, 1)
        button.Parent = controlPanel

        button.MouseButton1Click:Connect(function()
            -- ä½¿ç”¨åŸºäºè§†è§’çš„æ–¹å‘
            _G.moveDirection = getCameraRelativeDirection(dirInfo.dir)
            UpdatePartMovement()

            local originalColor = button.BackgroundColor3
            button.BackgroundColor3 = Color3.fromRGB(255, 255, 0)
            delay(0.2, function()
                button.BackgroundColor3 = originalColor
            end)
        end)
    end

    -- ç¿»è½¬æ§åˆ¶æ ‡é¢˜
    local flipLabel = Instance.new("TextLabel")
    flipLabel.Name = "FlipLabel"
    flipLabel.Size = UDim2.new(1, 0, 0, 40)
    flipLabel.Position = UDim2.new(0, 0, 0, 390)
    flipLabel.Text = "ç¿»è½¬æ§åˆ¶"
    flipLabel.TextColor3 = Color3.new(1, 1, 1)
    flipLabel.BackgroundTransparency = 1
    flipLabel.TextSize = 20
    flipLabel.Parent = controlPanel

    -- ç¿»è½¬æŒ‰é’®
    local flipButtons = {
        {name = "å·¦ç¿»è½¬", axis = "Y", value = -1, pos = UDim2.new(0.2, -30, 0, 440)},
        {name = "å³ç¿»è½¬", axis = "Y", value = 1, pos = UDim2.new(0.8, -30, 0, 440)},
        {name = "ä¸Šç¿»è½¬", axis = "X", value = 1, pos = UDim2.new(0.5, -30, 0, 400)},
        {name = "ä¸‹ç¿»è½¬", axis = "X", value = -1, pos = UDim2.new(0.5, -30, 0, 480)}
    }

    for i, flipInfo in ipairs(flipButtons) do
        local button = Instance.new("TextButton")
        button.Name = flipInfo.name
        button.Size = UDim2.new(0, 60, 0, 40)
        button.Position = flipInfo.pos
        button.Text = flipInfo.name
        button.TextSize = 14
        button.BackgroundColor3 = Color3.fromRGB(200, 100, 100)
        button.TextColor3 = Color3.new(1, 1, 1)
        button.Parent = controlPanel

        button.MouseButton1Click:Connect(function()
            if flipInfo.axis == "X" then
                _G.flipX = flipInfo.value
            elseif flipInfo.axis == "Y" then
                _G.flipY = flipInfo.value
            elseif flipInfo.axis == "Z" then
                _G.flipZ = flipInfo.value
            end

            UpdatePartMovement()

            local originalColor = button.BackgroundColor3
            button.BackgroundColor3 = Color3.fromRGB(255, 255, 0)
            delay(0.2, function()
                button.BackgroundColor3 = originalColor
            end)
        end)
    end

    -- å…³é—­é¢æ¿æŒ‰é’®
    local closeButton = Instance.new("TextButton")
    closeButton.Name = "ClosePanel"
    closeButton.Size = UDim2.new(0, 100, 0, 40)
    closeButton.Position = UDim2.new(0.5, -50, 0, 530)
    closeButton.Text = "å…³é—­é¢æ¿"
    closeButton.TextSize = 16
    closeButton.BackgroundColor3 = Color3.fromRGB(200, 100, 100)
    closeButton.TextColor3 = Color3.new(1, 1, 1)
    closeButton.Parent = controlPanel

    -- æ‰“å¼€é¢æ¿æŒ‰é’® - ç§»åŠ¨åˆ°å³ä¸Šè§’
    local openPanelButton = Instance.new("TextButton")
    openPanelButton.Name = "OpenPanel"
    openPanelButton.Size = UDim2.new(0, 120, 0, 40)
    openPanelButton.Position = UDim2.new(1, -160, 0, 70) -- å³ä¸Šè§’ï¼Œåœ¨é€‰æ‹©æ¨¡å¼æŒ‰é’®ä¸‹æ–¹
    openPanelButton.Text = "æ‰“å¼€æ§åˆ¶é¢æ¿"
    openPanelButton.TextSize = 14
    openPanelButton.BackgroundColor3 = Color3.fromRGB(100, 100, 200)
    openPanelButton.TextColor3 = Color3.new(1, 1, 1)
    openPanelButton.Visible = true
    openPanelButton.Parent = screenGui

    MakeDraggable(openPanelButton)

    -- é€‰æ‹©æ¨¡å¼çŠ¶æ€
    local selectMode = false

    -- é¼ æ ‡ç‚¹å‡»äº‹ä»¶å¤„ç†
    local function onMouseClick()
        if not selectMode then return end

        local targetPart = getTargetPart()
        if targetPart then
            if _G.selectedPart == targetPart then
                -- å¦‚æœç‚¹å‡»å·²é€‰æ‹©çš„é›¶ä»¶ï¼Œå–æ¶ˆé€‰æ‹©
                DeselectPart()
            else
                -- å°è¯•é€‰æ‹©æ–°é›¶ä»¶ï¼ˆå¦‚æœä¸å¯æ§åˆ¶ï¼Œä¸ä¼šå¼¹å‡ºæç¤ºï¼‰
                SelectPart(targetPart)
            end
        end
    end

    -- è¿æ¥é¼ æ ‡ç‚¹å‡»äº‹ä»¶
    UserInputService.InputBegan:Connect(function(input, gameProcessed)
        if gameProcessed then return end

        if input.UserInputType == Enum.UserInputType.MouseButton1 or 
           input.UserInputType == Enum.UserInputType.Touch then
            onMouseClick()
        end
    end)

    -- UIç¼©æ”¾åŠŸèƒ½
    scaleUpButton.MouseButton1Click:Connect(function()
        uiScale.Scale = math.min(uiScale.Scale + 0.1, 1.5)
        scaleLabel.Text = "UIå¤§å°: " .. string.format("%.1f", uiScale.Scale)
        local originalColor = scaleUpButton.BackgroundColor3
        scaleUpButton.BackgroundColor3 = Color3.fromRGB(0, 255, 0)
        delay(0.2, function()
            scaleUpButton.BackgroundColor3 = originalColor
        end)
    end)

    scaleDownButton.MouseButton1Click:Connect(function()
        uiScale.Scale = math.max(uiScale.Scale - 0.1, 0.5)
        scaleLabel.Text = "UIå¤§å°: " .. string.format("%.1f", uiScale.Scale)
        local originalColor = scaleDownButton.BackgroundColor3
        scaleDownButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
        delay(0.2, function()
            scaleDownButton.BackgroundColor3 = originalColor
        end)
    end)

-- é€Ÿåº¦æŒ‰é’®åŠŸèƒ½
speedUpButton.MouseButton1Click:Connect(function()
    _G.floatSpeed = math.clamp(_G.floatSpeed + 5, 1, 100)  -- å°†50æ”¹ä¸º100
    speedLabel.Text = "é€Ÿåº¦: " .. _G.floatSpeed
    UpdatePartMovement()

    local originalColor = speedUpButton.BackgroundColor3
    speedUpButton.BackgroundColor3 = Color3.fromRGB(0, 255, 0)
    delay(0.2, function()
        speedUpButton.BackgroundColor3 = originalColor
    end)
end)

speedDownButton.MouseButton1Click:Connect(function()
    _G.floatSpeed = math.clamp(_G.floatSpeed - 5, 1, 100)  -- å°†50æ”¹ä¸º100
    speedLabel.Text = "é€Ÿåº¦: " .. _G.floatSpeed
    UpdatePartMovement()

    local originalColor = speedDownButton.BackgroundColor3
    speedDownButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
    delay(0.2, function()
        speedDownButton.BackgroundColor3 = originalColor
    end)
end)

    -- åœæ­¢ç§»åŠ¨æŒ‰é’®åŠŸèƒ½
    stopButton.MouseButton1Click:Connect(function()
        _G.floatSpeed = 0
        UpdatePartMovement()
        speedLabel.Text = "é€Ÿåº¦: " .. _G.floatSpeed

        local originalColor = stopButton.BackgroundColor3
        stopButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
        delay(0.2, function()
            stopButton.BackgroundColor3 = originalColor
        end)
    end)

    -- åœæ­¢ç¿»è½¬æŒ‰é’®åŠŸèƒ½
    stopFlipButton.MouseButton1Click:Connect(function()
        StopFlip()

        local originalColor = stopFlipButton.BackgroundColor3
        stopFlipButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
        delay(0.2, function()
            stopFlipButton.BackgroundColor3 = originalColor
        end)
    end)

    -- é€‰æ‹©æ¨¡å¼å¼€å…³åŠŸèƒ½ - ä¿®æ”¹ä¸ºä¸æ‰“å¼€æ§åˆ¶é¢æ¿
    selectModeButton.MouseButton1Click:Connect(function()
        selectMode = not selectMode
        if selectMode then
            selectModeButton.Text = "é€‰æ‹©æ¨¡å¼: å¼€å¯"
            selectModeButton.BackgroundColor3 = Color3.fromRGB(0, 255, 0)
            print("é€‰æ‹©æ¨¡å¼å·²å¼€å¯")
        else
            selectModeButton.Text = "é€‰æ‹©æ¨¡å¼: å…³é—­"
            selectModeButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
            print("é€‰æ‹©æ¨¡å¼å·²å…³é—­")
        end
    end)

    -- å…³é—­é¢æ¿åŠŸèƒ½
    closeButton.MouseButton1Click:Connect(function()
        controlPanel.Visible = false
        openPanelButton.Visible = true
        print("æ§åˆ¶é¢æ¿å·²å…³é—­")
    end)

    -- æ‰“å¼€é¢æ¿åŠŸèƒ½
    openPanelButton.MouseButton1Click:Connect(function()
        controlPanel.Visible = true
        openPanelButton.Visible = false
        print("æ§åˆ¶é¢æ¿å·²æ‰“å¼€")
    end)

    return screenGui
end

-- æ·»åŠ é”™è¯¯å¤„ç†
local success, err = pcall(function()
    CreateMobileGUI()
end)

if not success then
    warn("GUIåˆ›å»ºå¤±è´¥: " .. tostring(err))

    -- æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
    local errorMsg = Instance.new("Message")
    errorMsg.Text = "æ¼‚æµ®æ§åˆ¶GUIåˆå§‹åŒ–å¤±è´¥: " .. tostring(err)
    errorMsg.Parent = Workspace
    delay(5, function()
        errorMsg:Destroy()
    end)
end